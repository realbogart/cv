<html>
  <head>
    <meta charset="UTF-8" />
    <link rel="stylesheet" href="style.css" />
    <!-- <script type="text/javascript" src="live.js"></script> -->
    <script>
      async function loadData() {
        const urlParams = new URLSearchParams(window.location.search);
        const jsonFile = urlParams.get('data') || 'data.json';
        const response = await fetch(jsonFile);
        const data = await response.json();

        // Populate header
        const headerH1 = document.querySelector(".header h1");
        const headerH2 = document.querySelector(".header h2");
        headerH1.textContent = data.header.name;
        headerH2.textContent = data.header.title;

        // Populate ABOUT ME section
        const aboutMeSection =
          document.querySelector(".main .section h1").parentElement;
        const aboutMeParagraphs = aboutMeSection.querySelectorAll("p");

        // Clear existing paragraphs
        aboutMeParagraphs.forEach((p) => p.remove());

        // Add new paragraphs from JSON
        data.aboutMe.paragraphs.forEach((paragraphText) => {
          const p = document.createElement("p");
          p.innerHTML = paragraphText;
          aboutMeSection.appendChild(p);
        });

        // Populate CONTACT section
        const contactSection =
          document.querySelector(".left .section h1").parentElement;
        const contactParagraph = contactSection.querySelector("p");

        // Clear existing contact content
        if (contactParagraph) {
          contactParagraph.remove();
        }

        // Create new contact paragraph with all contact items
        const p = document.createElement("p");
        Object.values(data.contact).forEach((contactItem) => {
          const a = document.createElement("a");
          a.href = contactItem.href;
          a.className = "contact";
          a.target = "_blank";
          a.innerHTML = `${contactItem.text} <img src="${contactItem.icon}" class="icon" /><br />`;
          p.appendChild(a);
        });

        contactSection.appendChild(p);

        // Populate sidebar sections
        const leftSidebar = document.querySelector(".left");
        const existingSections = leftSidebar.querySelectorAll(".section");

        // Remove existing sections except CONTACT (which is first)
        for (let i = 1; i < existingSections.length; i++) {
          existingSections[i].remove();
        }

        // Add new sections from JSON
        data.sidebarSections.forEach((sectionData) => {
          const sectionDiv = document.createElement("div");
          sectionDiv.className = "section";

          const h1 = document.createElement("h1");
          h1.textContent = sectionData.title.toUpperCase();
          sectionDiv.appendChild(h1);

          const contentDiv = document.createElement("div");
          contentDiv.innerHTML = sectionData.content;
          sectionDiv.appendChild(contentDiv);

          leftSidebar.appendChild(sectionDiv);
        });

        // Populate WORK EXPERIENCE section
        const workExperienceSection = document.querySelector(".main .section:nth-child(2)");
        const existingWorkContent = workExperienceSection.querySelectorAll(".experience");
        
        // Clear existing work experience content
        existingWorkContent.forEach(exp => exp.remove());
        
        // Add new work experience from JSON
        data.workExperience.forEach(company => {
          // Company header
          const companyDiv = document.createElement("div");
          companyDiv.className = "experience";
          
          const workplaceDiv = document.createElement("div");
          workplaceDiv.className = "workplace";
          workplaceDiv.innerHTML = `<b>${company.company}</b>`;
          
          const locationDiv = document.createElement("div");
          locationDiv.className = "info";
          locationDiv.textContent = company.location;
          
          companyDiv.appendChild(workplaceDiv);
          companyDiv.appendChild(locationDiv);
          workExperienceSection.appendChild(companyDiv);
          
          // Roles
          company.roles.forEach(role => {
            const roleDiv = document.createElement("div");
            roleDiv.className = "experience";
            
            const headerDiv = document.createElement("div");
            headerDiv.className = "experience-header";
            
            const roleTitleDiv = document.createElement("div");
            roleTitleDiv.className = "role";
            roleTitleDiv.textContent = role.title;
            
            const periodDiv = document.createElement("div");
            periodDiv.className = "info";
            periodDiv.textContent = role.period;
            
            headerDiv.appendChild(roleTitleDiv);
            headerDiv.appendChild(periodDiv);
            roleDiv.appendChild(headerDiv);
            
            // Responsibilities
            const listDiv = document.createElement("div");
            listDiv.className = "experience-list";
            
            const ul = document.createElement("ul");
            role.responsibilities.forEach(resp => {
              const li = document.createElement("li");
              li.innerHTML = `<b>${resp.title}:</b> ${resp.description}`;
              ul.appendChild(li);
            });
            
            listDiv.appendChild(ul);
            roleDiv.appendChild(listDiv);
            workExperienceSection.appendChild(roleDiv);
          });
        });
      }

      document.addEventListener("DOMContentLoaded", loadData);
    </script>
  </head>
  <body>
    <div class="container">
      <div class="header">
        <h1></h1>
        <h2></h2>
      </div>
      <div class="container_content">
        <div class="left">
          <div class="section">
            <h1>CONTACT</h1>
          </div>
        </div>
        <div class="main">
          <div class="section">
            <h1>ABOUT ME</h1>
          </div>
          <div class="section">
            <h1>WORK EXPERIENCE</h1>
          </div>
        </div>
      </div>
      <!-- <div class="footer"> -->
      <!--   "A bunchkins work is never done." <br /> -->
      <!--   - The Bunchkin -->
      <!-- </div> -->
    </div>
    <div
      style="
        overflow: hidden;
        height: 0;
        font-family: &quot;SourceSerifPro-Light&quot;;
      "
    >
      &nbsp;
    </div>
    <div
      style="
        overflow: hidden;
        height: 0;
        font-family: &quot;SourceSerifPro_18pt-Light&quot;;
      "
    >
      &nbsp;
    </div>
    <div
      style="
        overflow: hidden;
        height: 0;
        font-family: &quot;SourceSerifPro_36pt-Light&quot;;
      "
    >
      &nbsp;
    </div>
  </body>
</html>
